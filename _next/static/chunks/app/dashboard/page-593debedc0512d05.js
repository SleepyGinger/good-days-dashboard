(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{4137:(e,t,a)=>{"use strict";a.d(t,{default:()=>U});var r=a(5155),n=a(2115),s=a(2596),l=a(9688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.QP)((0,s.$)(t))}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:i("px-6",t),...a})}var c=a(4451);function u(e){let{...t}=e;return(0,r.jsx)(c._s.Root,{"data-slot":"drawer",...t})}function h(e){let{...t}=e;return(0,r.jsx)(c._s.Portal,{"data-slot":"drawer-portal",...t})}function g(e){let{className:t,...a}=e;return(0,r.jsx)(c._s.Overlay,{"data-slot":"drawer-overlay",className:i("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function m(e){let{className:t,children:a,...n}=e;return(0,r.jsxs)(h,{"data-slot":"drawer-portal",children:[(0,r.jsx)(g,{}),(0,r.jsxs)(c._s.Content,{"data-slot":"drawer-content",className:i("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...n,children:[(0,r.jsx)("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),a]})]})}function x(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"drawer-header",className:i("flex flex-col gap-1.5 p-4",t),...a})}function p(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"drawer-footer",className:i("mt-auto flex flex-col gap-2 p-4",t),...a})}function f(e){let{className:t,...a}=e;return(0,r.jsx)(c._s.Title,{"data-slot":"drawer-title",className:i("text-foreground font-semibold",t),...a})}var v=a(9708);let b=(0,a(2085).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function y(e){let{className:t,variant:a,size:n,asChild:s=!1,...l}=e,o=s?v.DX:"button";return(0,r.jsx)(o,{"data-slot":"button",className:i(b({variant:a,size:n,className:t})),...l})}function j(e){let{className:t,...a}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:i("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var w=a(6645),N=a(4109),k=a(3562),S=a(2355),C=a(3052),D=a(4616),E=a(5348);a(9303);var M=a(8544),z=a(3915),_=a(1115);function T(e){var t;let{open:a,onOpenChange:s,initial:l,onSave:i,onDelete:o}=e,[d,c]=(0,n.useState)(""),[h,g]=(0,n.useState)({}),[v,b]=(0,n.useState)(!1);(0,n.useEffect)(()=>{l?(c(l.title),g({from:new Date(l.start),to:l.end?new Date(l.end):void 0})):(c(""),g({}))},[l]);let j=async()=>{d.trim()&&h.from&&(b(!0),await i({id:null==l?void 0:l.id,title:d.trim(),start:R(h.from),end:h.to?R(h.to):null}),b(!1),s(!1))};return(0,r.jsx)(u,{open:a,onOpenChange:s,children:(0,r.jsxs)(m,{children:[(0,r.jsx)(x,{children:(0,r.jsx)(f,{children:l?"Edit Theme":"New Theme"})}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm opacity-70",children:"Title"}),(0,r.jsx)("input",{className:"w-full rounded bg-gray-800 p-2 text-sm",value:d,onChange:e=>c(e.target.value)})]}),(0,r.jsx)(E.h,{mode:"range",selected:h,onSelect:e=>g(null!=e?e:{}),numberOfMonths:1,defaultMonth:null!=(t=h.from)?t:new Date,styles:{day:{borderRadius:"0.5rem"}}}),(0,r.jsx)("p",{className:"text-xs opacity-60",children:h.from?"From ".concat(R(h.from)," ").concat(h.to?"to\xa0".concat(R(h.to)):"(open‑ended)"):"Pick a start date"})]}),(0,r.jsxs)(p,{className:"flex justify-between",children:[(null==l?void 0:l.id)&&o&&(0,r.jsx)(y,{variant:"destructive",onClick:async()=>{await o(l.id),s(!1)},children:"Delete"}),(0,r.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,r.jsx)(y,{variant:"ghost",onClick:()=>s(!1),children:"Cancel"}),(0,r.jsx)(y,{onClick:j,disabled:v,children:"Save"})]})]})]})})}function R(e){let t=e=>e.toString().padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}let F="firebase",O=null;try{let e=(0,z.Wp)({apiKey:"AIzaSyCOGsJMsgjvHmXJ7j17hzrsHDCjKmwaGQA",authDomain:"good-days-5515e.firebaseapp.com",databaseURL:"https://good-days-5515e-default-rtdb.firebaseio.com",projectId:"good-days-5515e",storageBucket:"good-days-5515e.appspot.com",messagingSenderId:"50443495976",appId:"1:50443495976:web:16e4d1fac4a23cda83631d",measurementId:"G-WXFZ6CSKPJ"});O=(0,_.C3)(e)}catch(e){console.warn("⚠️ Firebase DB unavailable, falling back to localStorage",e),F="local"}let A="moodData",G="themes";function L(e){try{return JSON.parse(localStorage.getItem(e)||"{}")}catch(e){return{}}}function K(e,t){localStorage.setItem(e,JSON.stringify(t)),window.dispatchEvent(new Event("storage"))}function I(e){return e.toString().padStart(2,"0")}function P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return"".concat(e.getFullYear(),"-").concat(I(e.getMonth()+1),"-").concat(I(e.getDate()))}function Y(e){let[t,a,r]=e.split("-");return new Date(Number(t),Number(a)-1,Number(r))}async function Z(e){let t=e.date.replace(/-/g,"");if("firebase"===F&&O)await (0,_.hZ)((0,_.KR)(O,"moodData/".concat(t)),e);else{let a=L(A);a[t]=e,K(A,a)}}async function B(e){let{id:t,...a}={...e,color:e.color||"#93c5fd"};if("firebase"===F&&O)t?await (0,_.hZ)((0,_.KR)(O,"themes/".concat(t)),a):await (0,_.hZ)((0,_.VC)((0,_.KR)(O,"themes")),a);else{let e=L(G);t?e[t]={id:t,...a}:e[a._id||crypto.randomUUID()]={...a},K(G,e)}}async function J(e){if("firebase"===F&&O)await (0,_.TF)((0,_.KR)(O,"themes/".concat(e)));else{let t=L(G);delete t[e],K(G,t)}}function U(){var e;(0,n.useEffect)(()=>document.documentElement.classList.add("dark"),[]);let t=function(){let[e,t]=(0,n.useState)([]);return(0,n.useEffect)(()=>(function(e){if("firebase"===F&&O){let t=(0,_.KR)(O,"moodData"),a=(0,_.Zy)(t,t=>{var a;return e(null!=(a=t.val())?a:{})});return()=>(0,_.AU)(t,"value",a)}let t=()=>e(L(A));return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)})(e=>{let a=new Map;Object.values(e).forEach(e=>{var t;e.date&&a.set(e.date,[...null!=(t=a.get(e.date))?t:[],e])}),t(Array.from(a.entries()).sort((e,t)=>e[0]<t[0]?1:-1).map(e=>{let[t,a]=e;return{date:t,items:a}}))}),[]),e}(),a=function(){let[e,t]=(0,n.useState)([]);return(0,n.useEffect)(()=>(function(e){if("firebase"===F&&O){let t=(0,_.KR)(O,"themes"),a=(0,_.Zy)(t,t=>{var a;e(Object.entries(null!=(a=t.val())?a:{}).map(e=>{let[t,a]=e;return{id:t,...a}}))});return()=>(0,_.AU)(t,"value",a)}let t=()=>{e(Object.entries(L(G)).map(e=>{let[t,a]=e;return{id:t,...a}}))};return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)})(t),[]),e}(),[s,l]=(0,n.useState)(null);(0,n.useEffect)(()=>{t.length&&l(t[Math.floor(Math.random()*t.length)])},[t]);let[i,c]=(0,n.useState)(!1),[h,g]=(0,n.useState)(!1),[v,b]=(0,n.useState)(null),[z,R]=(0,n.useState)(!1),[K,U]=(0,n.useState)(null),[X,Q]=(0,n.useState)(null),[q,$]=(0,n.useState)(P()),[ee,et]=(0,n.useState)("Good day"),[ea,er]=(0,n.useState)("Energized"),[en,es]=(0,n.useState)("Touching"),[el,ei]=(0,n.useState)("");(0,n.useEffect)(()=>{X&&($(X.date),et(X.day),er(X.energy),es(X.touch),ei(X.note))},[X]);let eo=async()=>{await Z({date:q,day:ee,energy:ea,touch:en,note:el}),Q(null),et("Good day"),er("Energized"),es("Touching"),ei(""),$(P()),c(!1)},ed=t.map(e=>Y(e.date)),[ec,eu]=(0,n.useState)(()=>{var e;return new Date(null!=(e=ed[0])?e:new Date)}),eh=n.useRef(null),[eg,em]=n.useState(null);n.useLayoutEffect(()=>{if(!eh.current)return;let e=eh.current.querySelector(".rdp-day");if(!e)return;let t=e.getBoundingClientRect(),a=eh.current.getBoundingClientRect(),r=t.top-a.top,n=t.width,s=getComputedStyle(e.parentElement);em({header:r,cell:n,gap:parseFloat(s.columnGap||s.rowGap||s.gap||s.getPropertyValue("gap")||"0")||0})},[ec]);let ex=function(e){if(!e.length)return 0;let t=e.map(e=>new Date(e).setHours(0,0,0,0)).sort((e,t)=>e-t),a=1,r=1;for(let e=1;e<t.length;e++){let n=t[e]-t[e-1];864e5===n?(r+=1,a=Math.max(a,r)):n>0&&(r=1)}return a}(t.map(e=>e.date)),ep=function(e){if(!e.length)return"–";let t=e.length;return(e.filter(e=>e.items.some(e=>"Good day"===e.day)).length/t*100).toFixed(0)+"%"}(t),ef=function(e,t){let a=(function(e){let t=new Date(e.getFullYear(),e.getMonth(),1),a=t.getDay();return new Date(t.getFullYear(),t.getMonth(),1-a)})(t).getTime(),r={},n=[];return e.sort((e,t)=>e.start.localeCompare(t.start)).forEach(e=>{let t=e.color||"#93c5fd",s=Y(e.start).getTime(),l=e.end?Y(e.end).getTime():s;for(;s<=l;){var i,o;let d=Math.round((s-a)/864e5),c=Math.floor(d/7),u=d%7;if((null!=(i=r[c])?i:0)>=2){s+=(7-u)*864e5;continue}let h=Math.min(Math.round((l-s)/864e5)+1,7-u);n.push({key:(e.id||e.title)+"-"+s,id:e.id||"",title:e.title,row:c,col:u,span:h,color:t}),r[c]=(null!=(o=r[c])?o:0)+1,s+=864e5*h}}),n}(a,ec);return(0,r.jsxs)("div",{className:"dark bg-gray-900 min-h-screen text-gray-100 p-4",children:[(0,r.jsxs)("main",{className:"mx-auto max-w-screen-sm flex flex-col gap-6",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Good\xa0Days"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(y,{variant:"ghost",onClick:()=>{U(null),R(!0)},className:"flex gap-2",children:[(0,r.jsx)(w.A,{size:16})," Themes"]}),t.length>0&&(0,r.jsxs)(y,{variant:"ghost",onClick:()=>l(t[Math.floor(Math.random()*t.length)]),className:"flex gap-2",children:[(0,r.jsx)(N.A,{size:16})," Random Day"]})]})]}),s&&(0,r.jsxs)(M.P.div,{layout:!0,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-indigo-600/20 p-4 rounded-2xl shadow-md space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-indigo-300",children:[(0,r.jsx)(k.A,{size:18}),(0,r.jsx)("span",{className:"uppercase tracking-wider text-xs",children:W(s.date)})]}),(0,r.jsx)("p",{className:"line-clamp-3 text-sm opacity-90",children:(null==(e=s.items[0])?void 0:e.note)||"(no note)"}),(0,r.jsx)(y,{size:"sm",onClick:()=>{b(s),g(!0)},children:"View full day"})]}),(0,r.jsxs)("section",{className:"grid sm:grid-cols-3 gap-4",children:[(0,r.jsx)(H,{label:"Days Logged",value:t.length}),(0,r.jsx)(H,{label:"Longest Streak",value:ex}),(0,r.jsx)(H,{label:"% Good Days",value:ep})]}),(0,r.jsx)("section",{className:"flex justify-center",children:(0,r.jsxs)("div",{ref:eh,className:"relative bg-gray-800 rounded-lg p-4",children:[eg&&ef.map(e=>(0,r.jsx)("div",{title:e.title,onClick:()=>{let t=a.find(t=>t.id===e.id);t&&(U(t),R(!0))},className:"absolute",style:{top:eg.header+e.row*(eg.cell+eg.gap),left:e.col*(eg.cell+eg.gap),width:e.span*eg.cell+(e.span-1)*eg.gap,height:8,backgroundColor:e.color,opacity:.3,borderRadius:4,cursor:"pointer"}},e.key)),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)(y,{size:"icon",variant:"ghost",onClick:()=>eu(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),children:(0,r.jsx)(S.A,{})}),(0,r.jsx)("p",{className:"font-medium",children:ec.toLocaleDateString(void 0,{month:"long",year:"numeric"})}),(0,r.jsx)(y,{size:"icon",variant:"ghost",onClick:()=>eu(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),children:(0,r.jsx)(C.A,{})})]}),(0,r.jsx)(E.h,{className:"mx-auto",month:ec,modifiers:{hasData:ed},modifiersClassNames:{hasData:"bg-indigo-600 text-white"},onDayClick:e=>{var a,r;let n="".concat(e.getFullYear(),"-").concat(I(e.getMonth()+1),"-").concat(I(e.getDate())),s=null!=(r=null==(a=t.find(e=>e.date===n))?void 0:a.items[0])?r:null;Q(s),s||$(n),c(!0)},classNames:{nav:"hidden",caption:"hidden",caption_label:"hidden"},styles:{head_cell:{color:"white"},day:{borderRadius:"0.5rem"}}}),0===t.length&&(0,r.jsx)("p",{className:"text-center text-sm opacity-60 pt-4",children:"No data yet. Start logging!"})]})}),(0,r.jsx)(u,{open:i,onOpenChange:c,children:(0,r.jsxs)(m,{children:[(0,r.jsx)(x,{children:(0,r.jsx)(f,{children:"New Entry"})}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)(V,{label:"Day",left:"Good day",right:"Bad day",value:ee,onChange:et}),(0,r.jsx)(V,{label:"Energy",left:"Energized",right:"Tired",value:ea,onChange:er}),(0,r.jsx)(V,{label:"Touch",left:"Touching",right:"No Touching",value:en,onChange:es}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm opacity-70",children:"Note"}),(0,r.jsx)(j,{value:el,onChange:e=>ei(e.target.value),placeholder:"What happened today?"})]})]}),(0,r.jsxs)(p,{className:"flex justify-end gap-2",children:[(0,r.jsx)(y,{variant:"ghost",onClick:()=>c(!1),children:"Cancel"}),(0,r.jsx)(y,{onClick:eo,children:"Save"})]})]})}),(0,r.jsx)(u,{open:h,onOpenChange:g,children:v&&(0,r.jsxs)(m,{children:[(0,r.jsx)(x,{children:(0,r.jsx)(f,{children:W(v.date)})}),(0,r.jsx)("div",{className:"p-6 space-y-4",children:v.items.map((e,t)=>(0,r.jsx)(o,{className:"bg-gray-800",children:(0,r.jsxs)(d,{className:"p-4 space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:["Day: ",(0,r.jsx)("strong",{children:e.day})]}),(0,r.jsxs)("p",{children:["Energy: ",(0,r.jsx)("strong",{children:e.energy})]}),(0,r.jsxs)("p",{children:["Touch: ",(0,r.jsx)("strong",{children:e.touch})]}),e.note&&(0,r.jsx)("p",{className:"pt-1 whitespace-pre-wrap",children:e.note})]})},t))})]})}),(0,r.jsx)(T,{open:z,onOpenChange:e=>{R(e),e||U(null)},initial:K,onSave:B,onDelete:(null==K?void 0:K.id)?J:void 0})]}),(0,r.jsx)(y,{onClick:()=>c(!0),className:"fixed bottom-6 right-6 h-14 w-14 rounded-full p-0 bg-indigo-600 hover:bg-indigo-500",children:(0,r.jsx)(D.A,{})})]})}function V(e){let{label:t,left:a,right:n,value:s,onChange:l}=e;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm opacity-70",children:t}),(0,r.jsx)("div",{className:"flex gap-2",children:[a,n].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>l(e),className:"px-3 py-1 rounded-full text-xs ".concat(s===e?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300"),children:e},e))})]})}function H(e){let{label:t,value:a}=e;return(0,r.jsx)(o,{className:"bg-gray-800",children:(0,r.jsxs)(d,{className:"p-4 space-y-1",children:[(0,r.jsx)("p",{className:"text-xs opacity-60",children:t}),(0,r.jsx)("p",{className:"text-xl font-bold",children:a})]})})}function W(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return new Date(e).toLocaleDateString(void 0,t?{weekday:"short",month:"short",day:"numeric",year:"numeric"}:{weekday:"short",month:"short",day:"numeric"})}},9368:(e,t,a)=>{Promise.resolve().then(a.bind(a,4137))}},e=>{var t=t=>e(e.s=t);e.O(0,[638,507,466,441,684,358],()=>t(9368)),_N_E=e.O()}]);